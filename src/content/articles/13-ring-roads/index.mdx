---
title: "One ring (road) to rule them all!"
summary: "Which Belgian ring road is the most circular, and hence the best one? An excessive analysis of Belgian ring roads no one asked for."
date: "12/23/2025"
draft: true
tags:
- Cartograpy
- Interactive
---

import RoadLabel from "../../../components/RoadLabel.astro"
import Definition from "../../../components/Definition.astro"
import Figure from "../../../components/Figure.astro"

## Introduction
Which Belgian ring road is the best ring? To answer this question, we first need to define what a ring road is:

<Definition 
    term="ring road"
    partOfSpeech="noun"
    pronunciation="/rĭng roʊd/"
    definitions={[
        { number: 1, text: "A circumferential highway around a town, city, or other conurbation." },
        { number: 2, text: "A highway that encircles an urban area so that traffic does not have to pass through the center.", example: "The Brussels Ring Road handles over 20 vehicles daily." }
    ]}
/>

In our case, let's call **all**, and **only**, roads that are referred to with an **R-number** a ring road. 
This excludes several national roads, such as the <RoadLabel label="N" number="712"/> around Pelt, which shows promising ring-like characteristics. 
If a road is not deemed impressive or important enough to warrant an R-number, it is certainly not impressive enough to be called the _ringiest_ Belgian ring road.  
Some ring roads were planned but ultimately failed to come to fruition. A notable example is the <RoadLabel label="R" number="7"/> around Liège, 
which was planned to be formed by the unfinished <RoadLabel label="A" number="604"/>, the <RoadLabel label="E" number="42"/>, the <RoadLabel label="E" number="25"/>, and the planned but cancelled <RoadLabel label="A" number="605"/>.

The name _"ring road"_ implies two properties of such roads: they are _ringlike_, and they are roads.  
The latter property is trivially satisfied by our definition above, so let's focus on the former:

<Definition
    term="ring" 
    partOfSpeech="noun" 
    pronunciation="/rĭng/"
    definitions={[
        { number: 1, text: "A circular object, form, line, or arrangement. " },
        { number: 2, text: "A small circular band, generally made of precious metal and often set with jewels, worn on the finger." },
        { number: 3, text: "A circular band used for carrying, holding, or containing something. ", example: "a wedding ring." }
    ]}
/>

Let's define a ring as **circular** and **closed**. 
The latter of these properties is a tad more flexible than the former, as an open ring is quite common, 
both in road infrastructure and in other _ringlike_ objects (e.g., a celtic torc).
The best ring road is hence the one that is the most circular while being reasonably closed.

As the problem is now clearly defined, we can focus on finding the solution. 
The next section will explain the method that was selected to evaluate the circularity, [or skip straight to the interactive visualization of the results](#results-and-conclusion).

## Method
The evaluation process consists of several steps:
1. **Data acquisition** from [OpenStreetMap](https://www.openstreetmap.org/#map=14/50.87997/4.70738),
2. **Rasterization** of the vector-formatted roads,
3. **Circle fitting** using RANSAC,
4. **Evaluation** of the circularity of the ring roads.

To facilitate the interpretation of the presented method, every step is illustrated with figures taken in between important steps. The ring road <RoadLabel label="R" number="23"/> around Leuven is selected as an example in a chauvinistic homage to my alma mater. 

### Data acquisition
#### Getting GeoJSON road data
Road data is acquired from OpenStreetMap using the [Overpass API](https://wiki.openstreetmap.org/wiki/Overpass_API).
The query given below is sent in the body of a `POST`request to the Overpass API. The response is a JSON object containing the relevant elements (including ways, traffic signals, zebra crossings, ...).  
For this article, only the ways are relevant, but it is nonetheless interesting to know that <RoadLabel label="R" number="23"/> contains **71** traffic lights and **32** zebra crossings (according to the Overpass query). 
The ring road with the most traffic signals is <RoadLabel label="R" number="22"/> with **228** signals. The same road <RoadLabel label="R" number="22"/> has the most zebra crossings with a respectable **101** crossings. 
The ring roads with the least amount of signals are those that consist of only highways, such as <RoadLabel label="R" number="0"/>. Brussels wins across the board! 
```javascript
// Set output format and timeout
[out:json][timeout:60];                         
// Get country area for filtering
area["ISO3166-1"="BE"]->.country;
// Union '(...)' combines queries into one
(
// Search ways in Belgium where "ref" matches R23
way(area.country)["highway"]["ref"="R23"];      
// Search groups of ways where "ref" matches R23
relation(area.country)["highway"]["ref"="R23"]; 
);
// Recursively fetch all nodes in the previous query
(._;>;);                                        
// Output the fetched data
out body;                                       
```

#### Transforming the fetched data
**TODO: Check this placeholder paragraph.**
Overpass returns the road data in **GeoJSON** format, which contains the vector representation of the roads as well as metadata such as the road name and type.
The original coordinates in **WGS84** format (longitude and latitude) are converted to local distances to the center of the road using an **equirectangular approximation** of the sphere, which is accurate enough for the small distances in this work.  
Evaluation in local distances is necessary to avoid distortions, as the Earth is **not** flat. 
Local distances is anyway how we normally think of the world, and is how most mapping applications represent the world.

<Figure
    src="/ring-roads/road_R23_BE_fetched.png"
    alt="Visualization of the transformation of the WGS84 coordinates into local kilometers to more intuitively represent the roads."
/>

### Rasterization
Because the road data is in vector format, it needs to be rasterized to avoid bias towards roads with more data points.
The vector lines representing roads are rasterized using **Bresenham's line algorithm** to a black and white image using a constant pixel size. Each pixel corresponds to a **5x5 m** square on the map. 
The image size is chosen to fit the entire road within.  
Next, the rasterized image is **dilated 32.5 m** (kernel size 13 px) to ensure that the road is continuous, as every road has an initial thickness of 1 pixel. 
Some roads, furthermore have gaps due to missing data in the OpenStreetMap response (e.g., overpasses or crossings). Some roads have wider lanes, a wide median, or multiple lanes, which are all part of the same road and result in multiple parallel-ish lines.  
The mask is finally **eroded 22.5 m** (kernel size 9 px) to give some width to the road, as the initial rasterized image is only one pixel or 5 m wide. The final road width is hence at least **20 m**.  
The figure below shows the intermediary road masks after every step. The algorithms that were used are quite common in computer vision and image processing and are readily available in the [`python-opencv`](https://pypi.org/project/opencv-python/) library. The rasterization process is given below the figure in simplified Python code.

<Figure
    src="/ring-roads/road_R23_BE_mask_rendering.png"
    alt="Visualization of the rasterization of ring road R23 (Leuven) showing the steps from vector data to rasterized image."
/>

``` python
import numpy as np
import cv2

def rasterize_road(local_lines):
    # Rasterize the list of vector lines from OpenStreetMap
    mask = Bresenham(local_lines, pixel_size=5)
    # Pad the mask with 20 black pixels on every side to avoid edge effects
    mask = np.pad(mask, pad_width=20, mode='constant', constant_values=0)
    # Dilate with kernel size 13x13 (65x65 m)
    mask = cv2.dilate(mask.astype(np.float32), np.ones((13,13), np.uint8))
    # Erode with kernel size 9x9 (45x45 m)
    mask = cv2.erode(mask.astype(np.float32), np.ones((9,9), np.uint8))
    # Remove padding
    mask = mask[20:-20, 20:-20]

    return mask
```

### Circle fitting
A circle is fitted to the rasterized road data using MSAC, a variant of RANSAC.

**TODO**: Explain MSAC briefly.

RANSAC is sufficient as exactly one circle will be present in the mask. Other possible options: (Circle) Hough Transform 




## Results and conclusion

TODO

To avoid bias, the initial order is set to the R-number while showing all ring roads. My personal 

import Roads from "Roads.astro"

<Roads/>

## Discussion


### Technical notes
Created with IsotopeJS
The road signs are a react component
